(()=>{var r={};r.id=446,r.ids=[446],r.modules={517:r=>{"use strict";r.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5639:(r,e,t)=>{"use strict";t.r(e),t.d(e,{headerHooks:()=>h,originalPathname:()=>p,patchFetch:()=>g,requestAsyncStorage:()=>d,routeModule:()=>s,serverHooks:()=>u,staticGenerationAsyncStorage:()=>c,staticGenerationBailout:()=>l});var n={};t.r(n),t.d(n,{POST:()=>f});var a=t(884),o=t(6132),i=t(1040);async function f(r){let e=t(862),n=t(6526),a=t(7653),o=await r.json(),i=o.chara||{},f=o.cover.replace(/^data:image\/\w+;base64,/,""),s=Buffer.from(f,"base64"),d=e(s),c=d.filter(r=>"tEXt"===r.name);for(let r of c)d.splice(d.indexOf(r),1);let u=JSON.stringify(i),h=Buffer.from(u,"utf8").toString("base64");d.splice(-1,0,a.encode("chara",h));let l=Buffer.from(n(d)),p=l.toString("base64"),g=`data:image/png;base64,${p}`;return new Response(g)}let s=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/makechar/route",pathname:"/api/makechar",filename:"route",bundlePath:"app/api/makechar/route"},resolvedPagePath:"C:\\Code\\GitHub\\CharacterEditor\\src\\app\\api\\makechar\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:d,staticGenerationAsyncStorage:c,serverHooks:u,headerHooks:h,staticGenerationBailout:l}=s,p="/api/makechar/route";function g(){return(0,i.patchFetch)({serverHooks:u,staticGenerationAsyncStorage:c})}},2400:(r,e)=>{(function(r){r.version="0.3.0";var e=function(){for(var r=0,e=Array(256),t=0;256!=t;++t)r=1&(r=1&(r=1&(r=1&(r=1&(r=1&(r=1&(r=1&(r=t)?-306674912^r>>>1:r>>>1)?-306674912^r>>>1:r>>>1)?-306674912^r>>>1:r>>>1)?-306674912^r>>>1:r>>>1)?-306674912^r>>>1:r>>>1)?-306674912^r>>>1:r>>>1)?-306674912^r>>>1:r>>>1)?-306674912^r>>>1:r>>>1,e[t]=r;return"undefined"!=typeof Int32Array?new Int32Array(e):e}(),t="undefined"!=typeof Buffer;function n(r){for(var t=-1,n=0,a=r.length-7;n<a;)t=(t=(t=(t=(t=(t=(t=(t=t>>>8^e[(t^r[n++])&255])>>>8^e[(t^r[n++])&255])>>>8^e[(t^r[n++])&255])>>>8^e[(t^r[n++])&255])>>>8^e[(t^r[n++])&255])>>>8^e[(t^r[n++])&255])>>>8^e[(t^r[n++])&255])>>>8^e[(t^r[n++])&255];for(;n<a+7;)t=t>>>8^e[(t^r[n++])&255];return -1^t}r.table=e,r.bstr=function(r){if(r.length>32768&&t)return n(new Buffer(r));for(var a=-1,o=r.length-1,i=0;i<o;)a=e[(a^r.charCodeAt(i++))&255]^a>>>8,a=e[(a^r.charCodeAt(i++))&255]^a>>>8;return i===o&&(a=a>>>8^e[(a^r.charCodeAt(i))&255]),-1^a},r.buf=function(r){if(r.length>1e4)return n(r);for(var t=-1,a=0,o=r.length-3;a<o;)t=(t=(t=(t=t>>>8^e[(t^r[a++])&255])>>>8^e[(t^r[a++])&255])>>>8^e[(t^r[a++])&255])>>>8^e[(t^r[a++])&255];for(;a<o+3;)t=t>>>8^e[(t^r[a++])&255];return -1^t},r.str=function(r){for(var t,n,a=-1,o=0,i=r.length;o<i;)(t=r.charCodeAt(o++))<128?a=a>>>8^e[(a^t)&255]:t<2048?a=(a=a>>>8^e[(a^(192|t>>6&31))&255])>>>8^e[(a^(128|63&t))&255]:t>=55296&&t<57344?(t=(1023&t)+64,n=1023&r.charCodeAt(o++),a=(a=(a=(a=a>>>8^e[(a^(240|t>>8&7))&255])>>>8^e[(a^(128|t>>2&63))&255])>>>8^e[(a^(128|n>>6&15|3&t))&255])>>>8^e[(a^(128|63&n))&255]):a=(a=(a=a>>>8^e[(a^(224|t>>12&15))&255])>>>8^e[(a^(128|t>>6&63))&255])>>>8^e[(a^(128|63&t))&255];return -1^a}})("undefined"==typeof DO_NOT_EXPORT_CRC?e:{})},884:(r,e,t)=>{"use strict";r.exports=t(517)},6842:r=>{"use strict";r.exports=function(r){r.data&&r.name&&(r=r.data);for(var e=!0,t="",n="",a=0;a<r.length;a++){var o=r[a];if(e)o?n+=String.fromCharCode(o):e=!1;else if(o)t+=String.fromCharCode(o);else throw Error("Invalid NULL character found. 0x00 character is not permitted in tEXt content")}return{keyword:n,text:t}}},1882:r=>{"use strict";r.exports=function(r,e){if(r=String(r),e=String(e),!/^[\x00-\xFF]+$/.test(r)||!/^[\x00-\xFF]+$/.test(e))throw Error("Only Latin-1 characters are permitted in PNG tEXt chunks. You might want to consider base64 encoding and/or zEXt compression");if(r.length>=80)throw Error('Keyword "'+r+'" is longer than the 79-character limit imposed by the PNG specification');for(var t,n=r.length+e.length+1,a=new Uint8Array(n),o=0,i=0;i<r.length;i++){if(!(t=r.charCodeAt(i)))throw Error("0x00 character is not permitted in tEXt keywords");a[o++]=t}a[o++]=0;for(var f=0;f<e.length;f++){if(!(t=e.charCodeAt(f)))throw Error("0x00 character is not permitted in tEXt content");a[o++]=t}return{name:"tEXt",data:a}}},7653:(r,e,t)=>{e.encode=t(1882),e.decode=t(6842)},6526:(r,e,t)=>{"use strict";var n=t(8278),a=t(2400);r.exports=function(r){var e,t=8,s=8;for(e=0;e<r.length;e++)t+=r[e].data.length+12;var d=new Uint8Array(t);for(e=0,d[0]=137,d[1]=80,d[2]=78,d[3]=71,d[4]=13,d[5]=10,d[6]=26,d[7]=10;e<r.length;e++){var c=r[e],u=c.name,h=c.data,l=h.length,p=[u.charCodeAt(0),u.charCodeAt(1),u.charCodeAt(2),u.charCodeAt(3)];f[0]=l,d[s++]=o[3],d[s++]=o[2],d[s++]=o[1],d[s++]=o[0],d[s++]=p[0],d[s++]=p[1],d[s++]=p[2],d[s++]=p[3];for(var g=0;g<l;)d[s++]=h[g++];var v=p.concat(n(h)),m=a.buf(v);i[0]=m,d[s++]=o[3],d[s++]=o[2],d[s++]=o[1],d[s++]=o[0]}return d};var o=new Uint8Array(4),i=new Int32Array(o.buffer),f=new Uint32Array(o.buffer)},862:(r,e,t)=>{"use strict";var n=t(2400);r.exports=function(r){if(137!==r[0]||80!==r[1]||78!==r[2]||71!==r[3])throw Error("Invalid .png file header");if(13!==r[4]||10!==r[5])throw Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");if(26!==r[6])throw Error("Invalid .png file header");if(10!==r[7])throw Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");for(var e=!1,t=[],f=8;f<r.length;){a[3]=r[f++],a[2]=r[f++],a[1]=r[f++],a[0]=r[f++];var s=i[0]+4,d=new Uint8Array(s);d[0]=r[f++],d[1]=r[f++],d[2]=r[f++],d[3]=r[f++];var c=String.fromCharCode(d[0])+String.fromCharCode(d[1])+String.fromCharCode(d[2])+String.fromCharCode(d[3]);if(!t.length&&"IHDR"!==c)throw Error("IHDR header missing");if("IEND"===c){e=!0,t.push({name:c,data:new Uint8Array(0)});break}for(var u=4;u<s;u++)d[u]=r[f++];a[3]=r[f++],a[2]=r[f++],a[1]=r[f++],a[0]=r[f++];var h=o[0];if(n.buf(d)!==h)throw Error("CRC values for "+c+" header do not match, PNG file is likely corrupted");var l=new Uint8Array(d.buffer.slice(4));t.push({name:c,data:l})}if(!e)throw Error(".png file ended prematurely: no IEND header was found");return t};var a=new Uint8Array(4),o=new Int32Array(a.buffer),i=new Uint32Array(a.buffer)},8278:r=>{"use strict";r.exports=function(r,e,t){var n=[],a=r.length;if(0===a)return n;var o=e<0?Math.max(0,e+a):e||0;for(void 0!==t&&(a=t<0?t+a:t);a-- >o;)n[a-o]=r[a];return n}}};var e=require("../../../webpack-runtime.js");e.C(r);var t=r=>e(e.s=r),n=e.X(0,[271],()=>t(5639));module.exports=n})();